!function(n,s){"object"==typeof exports&&"undefined"!=typeof module?module.exports=s(require("@/components/ContextMenu")):"function"==typeof define&&define.amd?define(["@/components/ContextMenu"],s):(n="undefined"!=typeof globalThis?globalThis:n||self).calendar=s(n.ContextMenu)}(this,(function(n){"use strict";function _interopDefaultLegacy(n){return n&&"object"==typeof n&&"default"in n?n:{default:n}}var s=_interopDefaultLegacy(n),i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function getDefaultExportFromCjs(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function getDefaultExportFromNamespaceIfPresent(n){return n&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function getDefaultExportFromNamespaceIfNotNamed(n){return n&&Object.prototype.hasOwnProperty.call(n,"default")&&1===Object.keys(n).length?n.default:n}function getAugmentedNamespace(n){if(n.__esModule)return n;var s=n.default;if("function"==typeof s){var i=function a(){return this instanceof a?Reflect.construct(s,arguments,this.constructor):s.apply(this,arguments)};i.prototype=s.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(n).forEach((function(s){var o=Object.getOwnPropertyDescriptor(n,s);Object.defineProperty(i,s,o.get?o:{enumerable:!0,get:function(){return n[s]}})})),i}var o={exports:{}},r=o.exports;!function(n,s){var o,r;o=i,r=function(){var n=1e3,s=6e4,i=36e5,o="millisecond",r="second",c="minute",u="hour",f="day",p="week",g="month",v="quarter",w="year",b="date",k="Invalid Date",C=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,z=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,H={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(n){var s=["th","st","nd","rd"],i=n%100;return"["+n+(s[(i-20)%10]||s[i]||s[0])+"]"}},m=function(n,s,i){var o=String(n);return!o||o.length>=s?n:""+Array(s+1-o.length).join(i)+n},T={s:m,z:function(n){var s=-n.utcOffset(),i=Math.abs(s),o=Math.floor(i/60),r=i%60;return(s<=0?"+":"-")+m(o,2,"0")+":"+m(r,2,"0")},m:function t(n,s){if(n.date()<s.date())return-t(s,n);var i=12*(s.year()-n.year())+(s.month()-n.month()),o=n.clone().add(i,g),r=s-o<0,c=n.clone().add(i+(r?-1:1),g);return+(-(i+(s-o)/(r?o-c:c-o))||0)},a:function(n){return n<0?Math.ceil(n)||0:Math.floor(n)},p:function(n){return{M:g,y:w,w:p,d:f,D:b,h:u,m:c,s:r,ms:o,Q:v}[n]||String(n||"").toLowerCase().replace(/s$/,"")},u:function(n){return void 0===n}},A="en",x={};x[A]=H;var E="$isDayjsObject",S=function(n){return n instanceof j||!(!n||!n[E])},L=function t(n,s,i){var o;if(!n)return A;if("string"==typeof n){var r=n.toLowerCase();x[r]&&(o=r),s&&(x[r]=s,o=r);var c=n.split("-");if(!o&&c.length>1)return t(c[0])}else{var u=n.name;x[u]=n,o=u}return!i&&o&&(A=o),o||!i&&A},O=function(n,s){if(S(n))return n.clone();var i="object"==typeof s?s:{};return i.date=n,i.args=arguments,new j(i)},Y=T;Y.l=L,Y.i=S,Y.w=function(n,s){return O(n,{locale:s.$L,utc:s.$u,x:s.$x,$offset:s.$offset})};var j=function(){function M(n){this.$L=L(n.locale,null,!0),this.parse(n),this.$x=this.$x||n.x||{},this[E]=!0}var H=M.prototype;return H.parse=function(n){this.$d=function(n){var s=n.date,i=n.utc;if(null===s)return new Date(NaN);if(Y.u(s))return new Date;if(s instanceof Date)return new Date(s);if("string"==typeof s&&!/Z$/i.test(s)){var o=s.match(C);if(o){var r=o[2]-1||0,c=(o[7]||"0").substring(0,3);return i?new Date(Date.UTC(o[1],r,o[3]||1,o[4]||0,o[5]||0,o[6]||0,c)):new Date(o[1],r,o[3]||1,o[4]||0,o[5]||0,o[6]||0,c)}}return new Date(s)}(n),this.init()},H.init=function(){var n=this.$d;this.$y=n.getFullYear(),this.$M=n.getMonth(),this.$D=n.getDate(),this.$W=n.getDay(),this.$H=n.getHours(),this.$m=n.getMinutes(),this.$s=n.getSeconds(),this.$ms=n.getMilliseconds()},H.$utils=function(){return Y},H.isValid=function(){return!(this.$d.toString()===k)},H.isSame=function(n,s){var i=O(n);return this.startOf(s)<=i&&i<=this.endOf(s)},H.isAfter=function(n,s){return O(n)<this.startOf(s)},H.isBefore=function(n,s){return this.endOf(s)<O(n)},H.$g=function(n,s,i){return Y.u(n)?this[s]:this.set(i,n)},H.unix=function(){return Math.floor(this.valueOf()/1e3)},H.valueOf=function(){return this.$d.getTime()},H.startOf=function(n,s){var i=this,o=!!Y.u(s)||s,v=Y.p(n),l=function(n,s){var r=Y.w(i.$u?Date.UTC(i.$y,s,n):new Date(i.$y,s,n),i);return o?r:r.endOf(f)},$=function(n,s){return Y.w(i.toDate()[n].apply(i.toDate("s"),(o?[0,0,0,0]:[23,59,59,999]).slice(s)),i)},k=this.$W,C=this.$M,z=this.$D,H="set"+(this.$u?"UTC":"");switch(v){case w:return o?l(1,0):l(31,11);case g:return o?l(1,C):l(0,C+1);case p:var T=this.$locale().weekStart||0,A=(k<T?k+7:k)-T;return l(o?z-A:z+(6-A),C);case f:case b:return $(H+"Hours",0);case u:return $(H+"Minutes",1);case c:return $(H+"Seconds",2);case r:return $(H+"Milliseconds",3);default:return this.clone()}},H.endOf=function(n){return this.startOf(n,!1)},H.$set=function(n,s){var i,p=Y.p(n),v="set"+(this.$u?"UTC":""),k=(i={},i[f]=v+"Date",i[b]=v+"Date",i[g]=v+"Month",i[w]=v+"FullYear",i[u]=v+"Hours",i[c]=v+"Minutes",i[r]=v+"Seconds",i[o]=v+"Milliseconds",i)[p],C=p===f?this.$D+(s-this.$W):s;if(p===g||p===w){var z=this.clone().set(b,1);z.$d[k](C),z.init(),this.$d=z.set(b,Math.min(this.$D,z.daysInMonth())).$d}else k&&this.$d[k](C);return this.init(),this},H.set=function(n,s){return this.clone().$set(n,s)},H.get=function(n){return this[Y.p(n)]()},H.add=function(o,v){var b,k=this;o=Number(o);var C=Y.p(v),y=function(n){var s=O(k);return Y.w(s.date(s.date()+Math.round(n*o)),k)};if(C===g)return this.set(g,this.$M+o);if(C===w)return this.set(w,this.$y+o);if(C===f)return y(1);if(C===p)return y(7);var z=(b={},b[c]=s,b[u]=i,b[r]=n,b)[C]||1,H=this.$d.getTime()+o*z;return Y.w(H,this)},H.subtract=function(n,s){return this.add(-1*n,s)},H.format=function(n){var s=this,i=this.$locale();if(!this.isValid())return i.invalidDate||k;var o=n||"YYYY-MM-DDTHH:mm:ssZ",r=Y.z(this),c=this.$H,u=this.$m,f=this.$M,p=i.weekdays,g=i.months,v=i.meridiem,h=function(n,i,r,c){return n&&(n[i]||n(s,o))||r[i].slice(0,c)},d=function(n){return Y.s(c%12||12,n,"0")},w=v||function(n,s,i){var o=n<12?"AM":"PM";return i?o.toLowerCase():o};return o.replace(z,(function(n,o){return o||function(n){switch(n){case"YY":return String(s.$y).slice(-2);case"YYYY":return Y.s(s.$y,4,"0");case"M":return f+1;case"MM":return Y.s(f+1,2,"0");case"MMM":return h(i.monthsShort,f,g,3);case"MMMM":return h(g,f);case"D":return s.$D;case"DD":return Y.s(s.$D,2,"0");case"d":return String(s.$W);case"dd":return h(i.weekdaysMin,s.$W,p,2);case"ddd":return h(i.weekdaysShort,s.$W,p,3);case"dddd":return p[s.$W];case"H":return String(c);case"HH":return Y.s(c,2,"0");case"h":return d(1);case"hh":return d(2);case"a":return w(c,u,!0);case"A":return w(c,u,!1);case"m":return String(u);case"mm":return Y.s(u,2,"0");case"s":return String(s.$s);case"ss":return Y.s(s.$s,2,"0");case"SSS":return Y.s(s.$ms,3,"0");case"Z":return r}return null}(n)||r.replace(":","")}))},H.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},H.diff=function(o,b,k){var C,z=this,H=Y.p(b),T=O(o),A=(T.utcOffset()-this.utcOffset())*s,x=this-T,D=function(){return Y.m(z,T)};switch(H){case w:C=D()/12;break;case g:C=D();break;case v:C=D()/3;break;case p:C=(x-A)/6048e5;break;case f:C=(x-A)/864e5;break;case u:C=x/i;break;case c:C=x/s;break;case r:C=x/n;break;default:C=x}return k?C:Y.a(C)},H.daysInMonth=function(){return this.endOf(g).$D},H.$locale=function(){return x[this.$L]},H.locale=function(n,s){if(!n)return this.$L;var i=this.clone(),o=L(n,s,!0);return o&&(i.$L=o),i},H.clone=function(){return Y.w(this.$d,this)},H.toDate=function(){return new Date(this.valueOf())},H.toJSON=function(){return this.isValid()?this.toISOString():null},H.toISOString=function(){return this.$d.toISOString()},H.toString=function(){return this.$d.toUTCString()},M}(),R=j.prototype;return O.prototype=R,[["$ms",o],["$s",r],["$m",c],["$H",u],["$W",f],["$M",g],["$y",w],["$D",b]].forEach((function(n){R[n[1]]=function(s){return this.$g(s,n[0],n[1])}})),O.extend=function(n,s){return n.$i||(n(s,j,O),n.$i=!0),O},O.locale=L,O.isDayjs=S,O.unix=function(n){return O(1e3*n)},O.en=x[A],O.Ls=x,O.p={},O},n.exports=r()}(o,o.exports);var c=o.exports,u=getDefaultExportFromCjs(c),f={exports:{}},p=f.exports;!function(n,s){var o,r;o=i,r=function(){return{name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(n){var s=["th","st","nd","rd"],i=n%100;return"["+n+(s[(i-20)%10]||s[i]||s[0])+"]"}}},n.exports=r()}(f,f.exports);var g,v=getDefaultExportFromCjs(f.exports),w={exports:{}},b=w.exports;!function(n,s){var o,r;o=i,r=function(n){function e(n){return n&&"object"==typeof n&&"default"in n?n:{default:n}}var s=e(n),i={name:"zh-tw",weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"週日_週一_週二_週三_週四_週五_週六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(n,s){return"W"===s?n+"週":n+"日"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日 HH:mm",LLLL:"YYYY年M月D日dddd HH:mm",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s內",past:"%s前",s:"幾秒",m:"1 分鐘",mm:"%d 分鐘",h:"1 小時",hh:"%d 小時",d:"1 天",dd:"%d 天",M:"1 個月",MM:"%d 個月",y:"1 年",yy:"%d 年"},meridiem:function(n,s){var i=100*n+s;return i<600?"凌晨":i<900?"早上":i<1100?"上午":i<1300?"中午":i<1800?"下午":"晚上"}};return s.default.locale(i,null,!0),i},n.exports=r(c)}(w,w.exports);var k,C=getDefaultExportFromCjs(w.exports),z={exports:{}},H=z.exports;!function(n,s){var o,r;o=i,r=function(n){function _(n){return n&&"object"==typeof n&&"default"in n?n:{default:n}}var s=_(n),i={name:"ja",weekdays:"日曜日_月曜日_火曜日_水曜日_木曜日_金曜日_土曜日".split("_"),weekdaysShort:"日_月_火_水_木_金_土".split("_"),weekdaysMin:"日_月_火_水_木_金_土".split("_"),months:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(n){return n+"日"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日 HH:mm",LLLL:"YYYY年M月D日 dddd HH:mm",l:"YYYY/MM/DD",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日(ddd) HH:mm"},meridiem:function(n){return n<12?"午前":"午後"},relativeTime:{future:"%s後",past:"%s前",s:"数秒",m:"1分",mm:"%d分",h:"1時間",hh:"%d時間",d:"1日",dd:"%d日",M:"1ヶ月",MM:"%dヶ月",y:"1年",yy:"%d年"}};return s.default.locale(i,null,!0),i},n.exports=r(c)}(z,z.exports);var T,A=getDefaultExportFromCjs(z.exports),x="undefined"!=typeof window?window:null,E=null===x,L=E?void 0:x.document,Y="addEventListener",j="removeEventListener",R="getBoundingClientRect",I="_a",N="_b",B="_c",F="horizontal",NOOP=function(){return!1},W=E?"calc":["","-webkit-","-moz-","-o-"].filter((function(n){var s=L.createElement("div");return s.style.cssText="width:"+n+"calc(9px)",!!s.style.length})).shift()+"calc",isString=function(n){return"string"==typeof n||n instanceof String},elementOrSelector=function(n){if(isString(n)){var s=L.querySelector(n);if(!s)throw new Error("Selector "+n+" did not match a DOM element");return s}return n},getOption=function(n,s,i){var o=n[s];return void 0!==o?o:i},getGutterSize=function(n,s,i,o){if(s){if("end"===o)return 0;if("center"===o)return n/2}else if(i){if("start"===o)return 0;if("center"===o)return n/2}return n},defaultGutterFn=function(n,s){var i=L.createElement("div");return i.className="gutter gutter-"+s,i},defaultElementStyleFn=function(n,s,i){var o={};return isString(s)?o[n]=s:o[n]=W+"("+s+"% - "+i+"px)",o},defaultGutterStyleFn=function(n,s){var i;return(i={})[n]=s+"px",i},Split=function(n,s){if(void 0===s&&(s={}),E)return{};var i=n,o,r,c,u,f,p;Array.from&&(i=Array.from(i));var g,v=elementOrSelector(i[0]).parentNode,w=getComputedStyle?getComputedStyle(v):null,b=w?w.flexDirection:null,k=getOption(s,"sizes")||i.map((function(){return 100/i.length})),C=getOption(s,"minSize",100),z=Array.isArray(C)?C:i.map((function(){return C})),H=getOption(s,"maxSize",1/0),T=Array.isArray(H)?H:i.map((function(){return H})),A=getOption(s,"expandToMin",!1),W=getOption(s,"gutterSize",10),J=getOption(s,"gutterAlign","center"),U=getOption(s,"snapOffset",30),P=Array.isArray(U)?U:i.map((function(){return U})),q=getOption(s,"dragInterval",1),V=getOption(s,"direction",F),X=getOption(s,"cursor",V===F?"col-resize":"row-resize"),Z=getOption(s,"gutter",defaultGutterFn),G=getOption(s,"elementStyle",defaultElementStyleFn),K=getOption(s,"gutterStyle",defaultGutterStyleFn);function setElementSize(n,s,i,r){var c=G(o,s,i,r);Object.keys(c).forEach((function(s){n.style[s]=c[s]}))}function setGutterSize(n,s,i){var r=K(o,s,i);Object.keys(r).forEach((function(s){n.style[s]=r[s]}))}function getSizes(){return p.map((function(n){return n.size}))}function getMousePosition(n){return"touches"in n?n.touches[0][r]:n[r]}function adjust(n){var s=p[this.a],i=p[this.b],o=s.size+i.size;s.size=n/this.size*o,i.size=o-n/this.size*o,setElementSize(s.element,s.size,this[N],s.i),setElementSize(i.element,i.size,this[B],i.i)}function drag(n){var i,o=p[this.a],r=p[this.b];this.dragging&&(i=getMousePosition(n)-this.start+(this[N]-this.dragOffset),q>1&&(i=Math.round(i/q)*q),i<=o.minSize+o.snapOffset+this[N]?i=o.minSize+this[N]:i>=this.size-(r.minSize+r.snapOffset+this[B])&&(i=this.size-(r.minSize+this[B])),i>=o.maxSize-o.snapOffset+this[N]?i=o.maxSize+this[N]:i<=this.size-(r.maxSize-r.snapOffset+this[B])&&(i=this.size-(r.maxSize+this[B])),adjust.call(this,i),getOption(s,"onDrag",NOOP)(getSizes()))}function calculateSizes(){var n=p[this.a].element,s=p[this.b].element,i=n[R](),r=s[R]();this.size=i[o]+r[o]+this[N]+this[B],this.start=i[c],this.end=i[u]}function innerSize(n){if(!getComputedStyle)return null;var s=getComputedStyle(n);if(!s)return null;var i=n[f];return 0===i?null:i-=V===F?parseFloat(s.paddingLeft)+parseFloat(s.paddingRight):parseFloat(s.paddingTop)+parseFloat(s.paddingBottom)}function trimToMin(n){var s=innerSize(v);if(null===s)return n;if(z.reduce((function(n,s){return n+s}),0)>s)return n;var i=0,o=[],r=n.map((function(r,c){var u=s*r/100,f=getGutterSize(W,0===c,c===n.length-1,J),p=z[c]+f;return u<p?(i+=p-u,o.push(0),p):(o.push(u-p),u)}));return 0===i?n:r.map((function(n,r){var c=n;if(i>0&&o[r]-i>0){var u=Math.min(i,o[r]-i);i-=u,c=n-u}return c/s*100}))}function stopDragging(){var n=this,i=p[n.a].element,o=p[n.b].element;n.dragging&&getOption(s,"onDragEnd",NOOP)(getSizes()),n.dragging=!1,x[j]("mouseup",n.stop),x[j]("touchend",n.stop),x[j]("touchcancel",n.stop),x[j]("mousemove",n.move),x[j]("touchmove",n.move),n.stop=null,n.move=null,i[j]("selectstart",NOOP),i[j]("dragstart",NOOP),o[j]("selectstart",NOOP),o[j]("dragstart",NOOP),i.style.userSelect="",i.style.webkitUserSelect="",i.style.MozUserSelect="",i.style.pointerEvents="",o.style.userSelect="",o.style.webkitUserSelect="",o.style.MozUserSelect="",o.style.pointerEvents="",n.gutter.style.cursor="",n.parent.style.cursor="",L.body.style.cursor=""}function startDragging(n){if(!("button"in n)||0===n.button){var i=this,o=p[i.a].element,r=p[i.b].element;i.dragging||getOption(s,"onDragStart",NOOP)(getSizes()),n.preventDefault(),i.dragging=!0,i.move=drag.bind(i),i.stop=stopDragging.bind(i),x[Y]("mouseup",i.stop),x[Y]("touchend",i.stop),x[Y]("touchcancel",i.stop),x[Y]("mousemove",i.move),x[Y]("touchmove",i.move),o[Y]("selectstart",NOOP),o[Y]("dragstart",NOOP),r[Y]("selectstart",NOOP),r[Y]("dragstart",NOOP),o.style.userSelect="none",o.style.webkitUserSelect="none",o.style.MozUserSelect="none",o.style.pointerEvents="none",r.style.userSelect="none",r.style.webkitUserSelect="none",r.style.MozUserSelect="none",r.style.pointerEvents="none",i.gutter.style.cursor=X,i.parent.style.cursor=X,L.body.style.cursor=X,calculateSizes.call(i),i.dragOffset=getMousePosition(n)-i.end}}V===F?(o="width",r="clientX",c="left",u="right",f="clientWidth"):"vertical"===V&&(o="height",r="clientY",c="top",u="bottom",f="clientHeight"),k=trimToMin(k);var Q=[];function adjustToMin(n){var s=n.i===Q.length,i=s?Q[n.i-1]:Q[n.i];calculateSizes.call(i);var o=s?i.size-n.minSize-i[B]:n.minSize+i[N];adjust.call(i,o)}function setSizes(n){var s=trimToMin(n);s.forEach((function(n,i){if(i>0){var o=Q[i-1],r=p[o.a],c=p[o.b];r.size=s[i-1],c.size=n,setElementSize(r.element,r.size,o[N],r.i),setElementSize(c.element,c.size,o[B],c.i)}}))}function destroy(n,s){Q.forEach((function(i){if(!0!==s?i.parent.removeChild(i.gutter):(i.gutter[j]("mousedown",i[I]),i.gutter[j]("touchstart",i[I])),!0!==n){var r=G(o,i.a.size,i[N]);Object.keys(r).forEach((function(n){p[i.a].element.style[n]="",p[i.b].element.style[n]=""}))}}))}return(p=i.map((function(n,s){var o={element:elementOrSelector(n),size:k[s],minSize:z[s],maxSize:T[s],snapOffset:P[s],i:s},r;if(s>0&&((r={a:s-1,b:s,dragging:!1,direction:V,parent:v})[N]=getGutterSize(W,s-1==0,!1,J),r[B]=getGutterSize(W,!1,s===i.length-1,J),"row-reverse"===b||"column-reverse"===b)){var c=r.a;r.a=r.b,r.b=c}if(s>0){var u=Z(s,V,o.element);setGutterSize(u,W,s),r[I]=startDragging.bind(r),u[Y]("mousedown",r[I]),u[Y]("touchstart",r[I]),v.insertBefore(u,o.element),r.gutter=u}return setElementSize(o.element,o.size,getGutterSize(W,0===s,s===i.length-1,J),s),s>0&&Q.push(r),o}))).forEach((function(n){var s=n.element[R]()[o];s<n.minSize&&(A?adjustToMin(n):n.minSize=s)})),{setSizes:setSizes,getSizes:getSizes,collapse:function collapse(n){adjustToMin(p[n])},destroy:destroy,parent:v,pairs:Q}};function splitInit({el:n,sizes:s=[20,80],minSize:i=350,gutterSize:o=3}){const r=Split(n,{sizes:s,minSize:i,expandToMin:!0,gutterSize:o,onDrag(){},onDragEnd(n){n=n.filter((n=>isNaN(+n))).length?[20,80]:n.map((n=>+n))}});return r.setSizes(s),r}var J={tw:{today:"今日",day:"日",month:"月",addnew_onder:"新增訂單",continuous_display:"連續顯示",autoassign_room:"自動排房",whole_building:"包棟",stock_notset:"無庫存",note:"註"},en:{today:"Today",day:"Day",month:"Month",addnew_onder:"New Order",continuous_display:"Continuous View",autoassign_room:"Automatic Room Assignment",whole_building:"Whole Building",stock_notset:"No Inventory Setup",note:"※"},ja:{today:"今日",day:"日",month:"月",addnew_onder:"注文の追加",continuous_display:"続けて表示する",autoassign_room:"自動で部屋を割り当て",whole_building:"建物全体",stock_notset:"在庫なし",note:"※"}};const U={guid(){function s4(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return[s4()+s4(),s4(),s4(),s4(),s4(),s4()+s4()].join("-")},cookies:{get(n){const s=document.cookie.split(";"),i={};return s.map((n=>{const s=n.trim().split("=");i[s[0]]=s[1]})),void 0===n?i:void 0===i[n]?void 0:decodeURIComponent(i[n])},del(n){this.cookies.set(n,"",-1)},set(n){if(void 0!==n){void 0===n.days&&(n.days=15);let s="";const i=new Date;i.setDate(i.getDate()+n.days),s=`expires=${i.toUTCString()};`;let o="";void 0!==n.domain&&(o=`domain=${n.domain};`);let r="SameSite=Lax;";void 0!==n.SameSite&&(r=`SameSite=${n.SameSite};`),document.cookie=`${n.key}=${encodeURIComponent(n.val)};${r}path=/;${s};${o}`}}},formatLang(n=""){let s=n?.toLowerCase();switch(s){case"cn":case"zh_cn":case"zh-cn":s="cn";break;case"en":case"en_us":case"en-us":s="en";break;case"tw":case"zh_tw":case"zh-tw":s="tw"}return s}};var P,q=void 0,V=void 0;function normalizeComponent(n,s,i,o,r,c,u,f,p,g){"boolean"!=typeof u&&(p=f,f=u,u=!1);const v="function"==typeof i?i.options:i;let w;if(n&&n.render&&(v.render=n.render,v.staticRenderFns=n.staticRenderFns,v._compiled=!0,r&&(v.functional=!0)),o&&(v._scopeId=o),c?(w=function(n){(n=n||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(n=__VUE_SSR_CONTEXT__),s&&s.call(this,p(n)),n&&n._registeredComponents&&n._registeredComponents.add(c)},v._ssrRegister=w):s&&(w=u?function(n){s.call(this,g(n,this.$root.$options.shadowRoot))}:function(n){s.call(this,f(n))}),w)if(v.functional){const n=v.render;v.render=function renderWithStyleInjection(s,i){return w.call(i),n(s,i)}}else{const n=v.beforeCreate;v.beforeCreate=n?[].concat(n,w):[w]}return i}const X={name:"ComponentsItem",components:{ContextMenu:s.default},props:{loading:{type:Boolean,default:!1},data:{type:Object,default:()=>({})},continuous:{type:Boolean,default:!1}},data:()=>({}),computed:{colSpan(){let n=null;if(this.continuous&&this.data._uids.length>1){const s=this.data._uids.indexOf(this.data._uid);n=["colspan-"+(this.data._uids.length-s)].join(" ")}return n}},mounted(){},methods:{dragStartHandler(n){n.rawData=this.data,this.$emit("dragstart",n)},hasSlot(n="default"){return!!this.$slots[n]||!!this.$scopedSlots[n]},clickHandler(){this.$emit("click",this.data)},assignClickHandler(n){n.stopPropagation(),this.$emit("assign",{value:this.data,e:n})},paymentStatusIcon(n){let s="fa-regular fa-credit-card";switch(n){case"deposit_unpaid":s="fa-solid fa-circle-exclamation fa-fw";break;case"unpaid":s="fa-regular fa-calendar-check"}return s}}};var __vue_render__$4=function(){var n=this,s=n.$createElement,i=n._self._c||s;return i("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"components-item",class:[n.data.checked_status,{assign:n.data.assign,unassign:!n.data.assign,continuous:n.continuous},n.colSpan],attrs:{id:n.data._uid,title:n.data.tooltip,"data-type":"item","data-_uid":n.data._uid,"data-_uids":n.data._uids,draggable:"true","data-order":n.data.order},on:{dragstart:n.dragStartHandler,click:n.clickHandler}},[i("b-overlay",{attrs:{"spinner-variant":"primary",show:n.loading}},[n.hasSlot("slot-item-info")?[n._t("slot-item-info",null,{scope:n.data})]:[n._v("\n      "+n._s(n.data.title)+",\n      "+n._s(n.data.start)+"-"+n._s(n.data.end)+",\n      "+n._s(n.data.assign)+"\n    ")],n._v(" "),i("div",{staticClass:"assign-button",on:{click:n.assignClickHandler}},[i("i",{staticClass:"fas fa-chevron-circle-right"})])],2)],1)},Z=[];__vue_render__$4._withStripped=!0;const G=undefined,K=undefined,Q=undefined,tt=undefined,et=undefined;var nt,st=void 0;const at={name:"ComponentsScheduler",components:{orderItem:normalizeComponent({render:__vue_render__$4,staticRenderFns:Z},void 0,X,"data-v-00d02a57",!1,void 0,!1,void 0,void 0,void 0)},props:{today:{type:[Object,Number,String],default:()=>Date.now()},loading:{type:Boolean,default:!1},showWait:{type:Boolean,default:!0},locale:{type:String,default:"en"},range:{type:Object,default:()=>({})},resource:{type:Array,default:()=>[]},stock:{type:Object,default:()=>({})},items:{type:Array,default:()=>[]},holiday:{type:Array,default:()=>[]},format:{type:String,default:"YYYY-MM-DD"},defaultHoliday:{type:Array,default:()=>[6,0]},allowChangeDate:{type:Boolean,default:!1},allowChangeType:{type:Boolean,default:!1},allowEdit:{type:Boolean,default:!1},allowContinuous:{type:Boolean,default:!1},allowAutoAssign:{type:Boolean,default:!1},marginTop:{type:Number,default:0}},data:()=>({cname:"resource-item",grouping:{},mousePosition:0,currentChildId:{}}),computed:{dict(){return J[this.lang]||J.en},lang(){return U.formatLang(this.locale)},now(){return u(this.today).format(this.format)},resourceList:{get(){return this.resource},set(n){this.$emit("update:resource",n)}},itemList:{get(){const n=this.deepCopy(this.items);return n.sort(((n,s)=>n.start===s.start?0:n.start>s.start?1:-1)),n},set(n){this.$emit("update:items",n)}},viewCount(){const n=u(this.range.start),s=undefined,i=undefined;return u(this.range.end).diff(n,"days")+1},dates(){const n=[...new Array(this.viewCount)].fill({}),s={};let i="";const o=n.map(((n,o)=>{const r=u(this.range.start).add(o,"days"),c=r.format(this.format),f=this.holiday.find((n=>n.date===c)),p=r.format("MM"),g=i!==p;return g&&(i=p),s[p]||(s[p]=0),s[p]++,{active:g,date:c,year:r.format("YYYY"),month:p,day:r.format("D"),week:r.format("dd"),...f?{holiday:f.display_name}:{}}}));return o.forEach((n=>{n.active&&(n.cols=s[n.month])})),o},dataResult(){const n={},s={};this.itemList.forEach((i=>{i.order_group=i.order_group||Math.random(),s[i.order_group]||(s[i.order_group]={});const o=this.resourceList.find((n=>n.id===i.room_type));o&&Array.isArray(o.children)&&o.children.find((n=>n.id===i.room_number_id))||(i.room_number_id=null,i.nan||(i.nan=1));const r=this.allowAutoAssign||i.assign?i.room_number_id:null;void 0===i._uid&&(i._uid=U.guid());const c=this.grouping[i._uid];let u=[i.room_type,r,c].join();const f=s[i.order_group][u];if(f){const o=f[f.length-1].end;f.length>0&&(f[0].start===i.start||o!==i.start)&&(n[u]||(n[u]=u+i.end),u=n[u]||u,s[i.order_group][u]||(s[i.order_group][u]=[]))}else s[i.order_group][u]=[];s[i.order_group][u].push(i)}));const i=this.deepCopy(this.itemList),o=this.checkOverwrite(i),r=[],c={};this.itemList.forEach((n=>{let i=this.allowAutoAssign||n.assign?n.room_number_id:null;if(o.length){const s=[n.start,n.room_type,n.room_number_id].join(),c=undefined;o.includes(s)&&(r.includes(s)?(i=null,n.room_number_id=null,n.nan=2):r.push(s))}const u=[n.start,n.room_type,i].join();c[u]||(c[u]=[]);let f=[],p=[];const g=Object.entries(s[n.order_group]).findIndex((([s,i])=>i.find((s=>s._uid===n._uid))));-1!==g&&(f=Object.entries(s[n.order_group])[g][1].map((n=>n._uid)),p=Object.entries(s[n.order_group])[g][1].map((n=>n.item_id))),c[u].push({...n,_uids:f,items:p})}));const u={};return Object.entries(c).forEach((([n,s])=>{s.sort(((n,s)=>{const i=n._uids.join(),o=s._uids.join();switch(`${!!u[i]}${!!u[o]}`){case"truetrue":return 0;case"truefalse":return-1;case"falsetrue":return 1}return n._uids.length===s._uids.length?0:n._uids.length>s._uids.length?-1:1})),s.forEach(((n,i)=>{if(n._uids.length){const i=n._uids.join();u[i]||(u[i]=this.getMinOrder(s,u),Object.entries(c).forEach((([n,s])=>{s.forEach(((n,s)=>{const o=undefined;(n._uids.join()||"")===i&&(n.order=u[i])}))})))}}))})),c},dateOpenList(){const n={};return this.dates.forEach((s=>{n[s]=this.getStock(s.date).full})),n}},watch:{items:{handler(){setTimeout((()=>{this.updateRowspan()}))},immediate:!0,deep:!0},allowAutoAssign:{handler(){setTimeout((()=>{this.updateRowspan()}))},immediate:!1,deep:!0},range:{handler(){this.resourceList.forEach((n=>{delete n.layout})),setTimeout((()=>{this.updateRowspan()}))},immediate:!1,deep:!0}},async mounted(){await this.$nextTick(),setTimeout((()=>{this.updateRowspan(),this.scrollEventSet(),window.scrollToToday()}))},methods:{hasSlot(n="default"){return!!this.$slots[n]||!!this.$scopedSlots[n]},isActive:n=>void 0===n.active||n.active,isAllActive(n){return this.isActive(n)&&(void 0===n.waitActive||n.waitActive)},updateItemPosition(){const n=this.deepCopy(this.itemList);n.forEach((n=>{const s=document.querySelector(`[data-_uid="${n._uid}"]`);if(s){const{left:i,right:o}=s.getBoundingClientRect();n.left=i.toFixed(0),n.right=o.toFixed(0)}})),this.itemList=n},mousedownHandler(n){this.mousePosition=n.x},i18n(n){return this.dict[n]},scrollEventSet(){const n=document.querySelector(".components-resource .resource-header.stuck"),s=document.querySelector(".components-scheduler .scheduler-header.stuck");n&&s&&(window.addEventListener("scroll",(()=>{this.offsetY=s.getBoundingClientRect().top+1-this.marginTop}),{once:!0}),window.addEventListener("scroll",(()=>{const i=undefined,o=this.getScroll().top-this.offsetY;s.style.top=o>0?`${o}px`:0,n.style.top=s.style.top}))),document.querySelector(".components-scheduler").addEventListener("scroll",(function(){document.querySelector(".header-months").scrollLeft=this.scrollLeft})),this.updateMonthsBarStyle()},updateMonthsBarStyle(){const n=document.querySelectorAll(".header-months > li > div");document.querySelectorAll(".scheduler-header .months > li > .scheduler-header-label").forEach(((s,i)=>{const o=s.getBoundingClientRect().width;n[i].style.setProperty("width",`${o}px`,"important");const r=s.parentElement.getBoundingClientRect().width+.5;n[i].parentElement.style.setProperty("width",`${r}px`),n[i].parentElement.style.removeProperty("z-index"),[...s.classList].includes("active")&&(n[i].parentElement.style.zIndex=1)}))},getScroll(){const n=document.body,s=document.documentElement,i=parseFloat(window.pageYOffset||n.scrollTop||s.scrollTop);return{top:i,bottom:n.clientHeight-window.innerHeight-i}},getStock(n,s){return this.stock[s]?.[n]||{}},checkStock(n,s){const i=undefined;return void 0!==this.getStock(n,s).stock},checkLock(n,s){const i=this.getStock(n,s);return void 0!==i.open&&!i.open},getAllStockFull(n){let s=!1;return Object.entries(this.stock).forEach((([i,o])=>{s||(s=!!o[n]?.full)})),s},getMinOrder(n,s){let i=1;if(n.length>1){const o=n.map((n=>s[n._uids.join()])).filter((n=>n));for(;o.includes(i);)i++}return i},waitDataResult(n){const s=this.dataResult[n]||[];return s.sort(((n,s)=>n.order===s.order?0:n.order>s.order?1:-1)),s},deepCopy:n=>JSON.parse(JSON.stringify(n)),isToday(n){return n===this.now},isWeekend(n){return this.defaultHoliday.includes(u(n).day())},isHoliday(n){const s=this.holiday.find((s=>s.date===n));return s?.display_name||""},dateTooltip(n){const s=[n],i=this.isToday(n),o=this.isHoliday(n);return i&&s.push(`(${this.i18n("today")})`),o&&s.push(`(${o})`),s.join("")},dateClickHandler(n,s){this.$emit("click",{type:"date",value:n,e:s})},stockClickHandler(n,s){const{date:i,room:o,num:r}=n;this.$emit("click",{type:"stock",value:n,data:this.getStock(i,o),e:s})},orderClickHandler(n){this.$emit("click",{type:"order",value:n})},assignClickHandler(n){const{value:s,e:i}=n;this.$emit("assign",{type:"assign",value:s,e:i})},itemClickHandler(n){const{date:s,room:i,num:o,full:r}=n;this.allowEdit&&!r&&this.$emit("click",{type:"item",value:n})},dragStartHandler(n){this.currentChildId=n.target.parentNode.dataset;const s=n.target?.dataset;if(s?._uid){const i={...this.currentChildId,_uid:s._uid,_uids:s._uids,rawData:n.rawData};this.dragTarget=i,n.dataTransfer.setData("text/plain",JSON.stringify(i)),n.dataTransfer.effectAllowed="move"}n.target.style.opacity=.5,this.$emit("drop-start",n)},dragOverHandler(n){document.body.style.cursor="";const{type:s,id:i,date:o,disabled:r}=n.target.dataset;if("true"===r)document.body.style.cursor="not-allowed",n.target.style.background="#f2f2f2";else{n.preventDefault();const r=n.target.querySelectorAll(".components-item").length;if(!i||"wait"!==s&&r||(n.target.style.background="#f2f2f2"),this.allowChangeDate||o!==this.currentChildId.date&&(document.body.style.cursor="not-allowed"),!this.allowChangeType)try{const n=(i||"").split(",")[0],s=undefined;n!==(this.currentChildId.id||"").split(",")[0]&&(document.body.style.cursor="not-allowed")}catch(n){}}n.target.style.pointerEvents="","item"===s&&(n.target.style.pointerEvents="none"),this.$emit("drop-over",n)},dragLeaveHandler(n){n.preventDefault(),n.target.style.background="",this.$emit("drop-leave",n)},dragEnterHandler(n){n.preventDefault(),this.$emit("drop-enter",n)},dragEndHandler(n){n.preventDefault(),this.clearDragStyle(),this.$emit("drop-end",n)},dropHandler(n){if(n.preventDefault(),this.clearDragStyle(n),!this.allowChangeType)try{const s=undefined,i=(JSON.parse(n.dataTransfer.getData("text/plain")).id||"").split(",")[0],o=undefined;if(i!==(n.target.dataset.id||"").split(",")[0])return void this.updateRowspan()}catch(n){return}const{type:s,id:i}=n.target.dataset;if(i){const i=n.target.querySelectorAll(".components-item").length,o="wait"!==s;try{const r=JSON.parse(n.dataTransfer.getData("text/plain")),{_uid:c,_uids:f,rawData:p}=r,{date:g,id:v}=n.target.dataset,[w,b]=v.split(",").map((n=>+n));if("wait"===s||!i||v===r.id){const s=this.deepCopy(this.itemList);if(this.allowContinuous){const n=f.split(",");let i=0;if(this.allowChangeDate){let o=-1,r=Number.MAX_SAFE_INTEGER;n.forEach(((n,i)=>{const c=s.findIndex((s=>s._uid===n)),u=+s[c].left,f=this.mousePosition-u;f>0&&f<r&&(r=f,o=i)}));const c=s.findIndex((s=>s._uid===n[o]));i=u(g).diff(u(s[c].start),"days")}else if(g!==r.date)return;n.forEach((n=>{const r=s.findIndex((s=>s._uid===n));s[r].assign=o,s[r].room_type=w,s[r].room_number_id=b||null,i&&(s[r].start=u(s[r].start).add(i,"days").format(this.format),s[r].end=u(s[r].end).add(i,"days").format(this.format))}))}else{const i=s.findIndex((n=>n._uid===c));s[i].assign=o,s[i].room_type=w,s[i].room_number_id=b||null;const r=u(g).diff(u(s[i].start),"days");if(!this.allowChangeDate)try{const s=JSON.parse(n.dataTransfer.getData("text/plain")),i=n.target.dataset.date;if(s.date&&s.date!==i)return void this.updateRowspan()}catch(n){return}r&&(s[i].start=g,s[i].end=u(s[i].end).add(r,"days").format(this.format))}const i=this.checkOverwrite(s);if(i.length){const n=i[0].split(","),s=document.querySelector(['[data-type="content"]',`[data-date="${n[0]}"]`,`[data-id="${[n[1],n[2]].join()}"]`].join(""));s&&(s.classList.add("easeInAnim"),setTimeout((()=>{s.classList.remove("easeInAnim")}),500))}else setTimeout((()=>{this.itemList=s,this.$emit("drop",{_uid:c,date:g,room:w,...b?{num:b}:null,rawData:p})}))}}catch(n){return}}setTimeout((()=>{this.grouping={},this.updateRowspan()}))},clearDragStyle(){this.currentChildId={},document.body.style.cursor="",document.querySelectorAll(".components-item").forEach((n=>{n.style.pointerEvents="",n.style.background="",n.style.opacity=""})),document.querySelectorAll(".resource-item li > div[data-type]").forEach((n=>{n.style.background=""}))},updateRowspan(){if(this.debounceSettimeoutUpdateRowspan)return;clearTimeout(this.debounceSettimeoutUpdateRowspan),this.debounceSettimeoutUpdateRowspan=setTimeout((()=>{delete this.debounceSettimeoutUpdateRowspan}),100);const n=this.deepCopy(this.resourceList);n.forEach(((s,i)=>{delete n[i].layout}));const s=[],i=[`.${this.cname} [data-type="wait"]`,`.${this.cname} [data-type="content"]`].join();document.querySelectorAll(i).forEach((i=>{const o=i.querySelectorAll(".components-item").length,r=i.dataset.id,c=r.split(",")[0],u=r.split(",")[1],f=n.findIndex((n=>n.id===+c));if(-1!==f){const i=n[f];i.layout||(i.layout={}),i.layout[u]||(i.layout[u]={rowspan:0}),"wait"===u&&(s[c]||(s[c]=0),s[c]+=o,i.layout[u].waitRowspan=s[c]),i.layout[u].rowspan=Math.max(i.layout[u].rowspan,o),this.allowAutoAssign&&(i.waitActive=!0),n[f]=i}})),this.resourceList=n,setTimeout((()=>{this.clearDragStyle(),this.updateItemPosition(),this.updateMonthsBarStyle()}))},checkOverwrite(n){const s=this.deepCopy(n),i={};return this.allowAutoAssign||s.forEach((n=>{n.assign||(n.room_number_id=null)})),s.filter((n=>n.room_number_id)).forEach((n=>{const s=[n.start,n.room_type,n.room_number_id].join();i[s]||(i[s]=[]),i[s].push(n)})),[...new Set(Object.entries(i).map((n=>n[1])).filter((n=>n.length>1)).flat().map((n=>[n.start,n.room_type,n.room_number_id].join())))]},parseLayoutInfo:(n,s)=>n?.layout?.[s]?.rowspan||1}};var __vue_render__$3=function(){var n=this,s=n.$createElement,i=n._self._c||s;return i("div",{staticClass:"components-scheduler"},[i("ul",{staticClass:"header-months"},n._l(n.dates,(function(s,o){return i("li",{key:"header-months_"+o,attrs:{title:s.year+"/"+s.month}},[i("div",{class:[{active:s.active},s.cols?"colspan-"+s.cols:""]},[n._v("\n        "+n._s(s.year)+"/"+n._s(s.month)+"\n      ")])])})),0),n._v(" "),i("b-overlay",{class:"view-"+n.viewCount,attrs:{"spinner-variant":"primary",show:n.loading}},[i("b-form-row",{staticClass:"scheduler-header stuck"},[i("b-col",{attrs:{cols:"12"}},[i("ul",{staticClass:"months"},n._l(n.dates,(function(s,o){return i("li",{key:"months_"+o,attrs:{title:s.year+"/"+s.month}},[i("div",{class:["scheduler-header-label",{active:s.active},s.cols?"colspan-"+s.cols:""]},[n._v("\n              "+n._s(s.year)+"/"+n._s(s.month)+"\n            ")])])})),0)]),n._v(" "),i("b-col",{attrs:{cols:"12"}},[i("ul",{staticClass:"dates"},n._l(n.dates,(function(s,o){return i("li",{key:"dates_"+o,class:["cursor-pointer",{today:n.isToday(s.date),holiday:n.isHoliday(s.date),weekend:n.isWeekend(s.date)}],attrs:{id:"dates_"+o,boundary:"document"},on:{click:function(i){return n.dateClickHandler(s.date,i)}}},[i("div",[i("span",[n._v(n._s(s.week)+" "+n._s(s.day))]),n._v(" "),n.getAllStockFull(s.date)?i("small",{staticClass:"wb-icon"},[n._v("\n                "+n._s(n.i18n("whole_building"))+"\n              ")]):n._e()]),n._v(" "),i("b-tooltip",{attrs:{target:"dates_"+o,"custom-class":"b-tooltip-class",placement:"top",triggers:"hover",boundary:"document"}},[n._v("\n              "+n._s(n.dateTooltip(s.date))+"\n            ")])],1)})),0)])],1),n._v(" "),n._l(n.resourceList,(function(s,o){return[i("b-form-row",{key:"contents_"+o,staticClass:"contents-row stock"},[i("b-col",{class:n.cname,attrs:{cols:"12"}},[i("ul",{staticClass:"contents stock"},n._l(n.dates,(function(r,c){return i("li",{key:"contents_"+o+"_"+c,class:{full:n.getStock(r.date,s.id).full,"stock-notset":!n.checkStock(r.date,s.id)}},[i("div",{on:{click:function(i){return n.stockClickHandler({date:r.date,room:s.id},i)}}},[n.hasSlot("slot-item-stock")?[n._t("slot-item-stock",null,{scope:n.getStock(r.date,s.id)})]:[n.checkLock(r.date,s.id)?i("small",{staticClass:"lock-icon"},[i("i",{staticClass:"fa-solid fa-lock"})]):n._e(),n._v(" "),n.checkStock(r.date,s.id)?i("span",[n._v("\n                    "+n._s(n.getStock(r.date,s.id).stock)+"\n                  ")]):i("small",[n._v("\n                    "+n._s(n.i18n("stock_notset"))+"\n                  ")])]],2)])})),0)])],1),n._v(" "),n.showWait?i("b-form-row",{key:"contents_wait_"+o,class:["contents-row collapse-wait",{active:n.isAllActive(s)}]},[i("b-col",{class:[n.cname,"rowspan-1","rowspan-"+n.parseLayoutInfo(s,"wait")],attrs:{cols:"12"}},[i("ul",{staticClass:"contents wait"},n._l(n.dates,(function(r,c){return i("li",{key:"contents_wait_"+o+"_"+c,class:{full:n.getStock(r.date,s.id).full}},[i("div",{attrs:{"data-type":"wait",droppable:"true","data-date":r.date,"data-id":[s.id,"wait"].join()},on:{dragenter:n.dragEnterHandler,dragleave:n.dragLeaveHandler,dragover:n.dragOverHandler,dragend:n.dragEndHandler,drop:n.dropHandler,click:function(i){if(i.target!==i.currentTarget)return null;n.itemClickHandler({date:r.date,room:s.id,num:"wait",full:n.getStock(r.date,s.id).full})},mousedown:n.mousedownHandler}},[n._l(n.waitDataResult([r.date,s.id,""].join()),(function(s,o){return[i("order-item",{key:"order-item_"+o,class:"item-order-"+s.order,attrs:{data:s,continuous:n.allowContinuous},on:{dragstart:n.dragStartHandler,click:n.orderClickHandler,assign:n.assignClickHandler},scopedSlots:n._u([n.hasSlot("slot-item-info")?{key:"slot-item-info",fn:function(s){var i=s.scope;return[n._t("slot-item-info",null,{scope:i})]}}:null],null,!0)})]}))],2)])})),0)])],1):n._e(),n._v(" "),n._l(s.children,(function(r,c){return i("b-form-row",{key:"contents_"+o+"_"+c,class:["contents-row collapse",{active:n.isActive(s)}]},[i("b-col",{class:n.cname,attrs:{cols:"12"}},[i("ul",{staticClass:"contents"},n._l(n.dates,(function(u,f){return i("li",{key:"contents_"+o+"_"+c+"_"+f,class:{full:n.getStock(u.date,s.id).full}},[i("div",{attrs:{"data-type":"content","data-date":u.date,"data-id":[s.id,r.id].join(),"data-disabled":r.disabled},on:{dragenter:n.dragEnterHandler,dragleave:n.dragLeaveHandler,dragover:n.dragOverHandler,dragend:n.dragEndHandler,drop:n.dropHandler,click:function(i){if(i.target!==i.currentTarget)return null;n.itemClickHandler({date:u.date,room:s.id,num:r.id,full:n.getStock(u.date,s.id).full})},mousedown:n.mousedownHandler}},[n._l(n.dataResult[[u.date,s.id,r.id].join()]||[],(function(s,o){return[i("order-item",{key:"order-item_"+o,attrs:{data:s,continuous:n.allowContinuous},on:{dragstart:n.dragStartHandler,click:n.orderClickHandler,assign:n.assignClickHandler},scopedSlots:n._u([n.hasSlot("slot-item-info")?{key:"slot-item-info",fn:function(s){var i=s.scope;return[n._t("slot-item-info",null,{scope:i})]}}:null],null,!0)})]}))],2)])})),0)])],1)}))]}))],2)],1)},it=[];__vue_render__$3._withStripped=!0;const ot=undefined,rt=undefined,lt=undefined,dt=undefined,ct=normalizeComponent({render:__vue_render__$3,staticRenderFns:it},void 0,at,"data-v-7f57384b",!1,void 0,!1,void 0,void 0,void 0);var ut,ht=void 0,ft=void 0;const pt={name:"ComponentsResource",components:{},props:{debug:{type:Boolean,default:!1},headerTitle:{type:String,default:"Header Title"},showWait:{type:Boolean,default:!0},waitTitle:{type:String,default:"Wait Title"},data:{type:Array,default:()=>[]}},data:()=>({pageLoad:!1,expandAll:!0}),computed:{checkHasSomeChild(){return this.dataList.map((n=>n.children&&n.children.length)).filter((n=>n)).reduce(((n,s)=>n+s),0)},dataList:{get(){const n=undefined;return[...this.data.map((n=>({...n,active:void 0===n.active||n.active,waitActive:void 0===n.waitActive||n.waitActive})))]},set(n){this.$emit("update:data",n)}},isAllExpand(){return!this.dataList.some((n=>!n.active))},isAllCollapse(){return!this.dataList.some((n=>n.active))}},mounted(){const n=this.dataList.map((n=>({...n,active:void 0===n.active||n.active})));this.pageLoad||(this.pageLoad=!0,this.dataList=n)},methods:{hasChild:n=>n&&Array.isArray(n.children)&&n.children.length,hasSlot(n="default"){return!!this.$slots[n]||!!this.$scopedSlots[n]},collapseAllClickHandler(n=0){0===n&&(this.expandAll=!this.expandAll),n<this.dataList.length&&(this.dataList[n].active=this.expandAll,this.dataList=[...this.dataList],setTimeout((()=>{this.collapseAllClickHandler(n+=1)}),100))},collapseWaitClickHandler(n){const s=this.dataList;s[n].waitActive=!s[n].waitActive,this.dataList=s},collapseClickHandler(n){const s=this.dataList;s[n].active=!s[n].active,this.hasChild(s[n])&&(this.dataList=s,this.isAllCollapse&&(this.expandAll=!1),this.isAllExpand&&(this.expandAll=!0))},parseLayoutInfo:(n,s)=>n?.layout?.[s]?.rowspan||1}};var __vue_render__$2=function(){var n=this,s=n.$createElement,i=n._self._c||s;return i("div",{staticClass:"components-resource"},[i("div",{staticClass:"resource-header stuck"},[i("span",{staticClass:"arrow-icon ellipsis-1",class:{active:n.expandAll},on:{click:function(s){return n.collapseAllClickHandler()}}},[n.checkHasSomeChild?i("i",{staticClass:"fa-solid fa-angles-down"}):n._e(),n._v(" "+n._s(n.headerTitle)+"\n    ")])]),n._v(" "),n._l(n.dataList,(function(s,o){return[i("b-form-row",{key:o,staticClass:"resource-type"},[i("b-col",{staticClass:"resource-item",attrs:{cols:"12"}},[i("b-form-row",{staticClass:"append-item"},[i("b-col",{staticClass:"label p-0",attrs:{"data-id":s.id}},[i("span",{staticClass:"arrow-icon ellipsis-1",class:{active:s.active},on:{click:function(s){return n.collapseClickHandler(o)}}},[n.hasChild(s)?i("i",{staticClass:"fa-solid fa-angle-down"}):n._e(),n._v(" "),i("span",{staticClass:"pl-1"},[n._v(n._s(s.name))])]),n._v(" "),n.parseLayoutInfo(s,"wait")>1?[i("b-badge",{staticClass:"b-badge-class",attrs:{id:"badge_"+o},on:{click:function(s){return n.collapseWaitClickHandler(o)}}},[n._v("\n                "+n._s(s.layout.wait.waitRowspan)+"\n              ")]),n._v(" "),i("b-tooltip",{attrs:{target:"badge_"+o,"custom-class":"b-tooltip-class",placement:"topright",triggers:"hover",boundary:"document"}},[n._v("\n                "+n._s(n.waitTitle)+"\n              ")])]:n._e()],2),n._v(" "),s.extend?[i("b-col",{attrs:{cols:"auto"}},[i("small",[n._v(n._s(s.extend))])])]:n._e()],2)],1)],1),n._v(" "),n.showWait?i("b-form-row",{key:"contents_wait_"+o,staticClass:"contents-row collapse-wait",class:{active:s.active&&s.waitActive}},[i("b-col",{staticClass:"resource-children-item",class:["rowspan-1","rowspan-"+n.parseLayoutInfo(s,"wait")],attrs:{cols:"12"}},[i("b-form-row",{staticClass:"append-item"},[i("b-col",{staticClass:"label"},[i("span",{staticClass:"pl-3"},[n._v(n._s(n.waitTitle))])])],1)],1)],1):n._e(),n._v(" "),n._l(s.children,(function(r,c){return i("b-form-row",{key:"contents_"+o+"_"+c,staticClass:"contents-row collapse",class:{active:s.active}},[i("b-col",{staticClass:"resource-children-item",attrs:{cols:"12"}},[i("b-form-row",{staticClass:"append-item"},[i("b-col",{staticClass:"label",attrs:{"data-id":r.id,"data-rowspan":n.parseLayoutInfo(s,r.id)}},[i("span",{staticClass:"pl-3"},[n._v(n._s(r.name))])]),n._v(" "),r.disabled?i("b-col",{staticClass:"pr-0",attrs:{cols:"auto"}},[i("i",{staticClass:"fa-solid fa-ban"})]):n._e(),n._v(" "),n.hasSlot("slot-resource-info")?[i("b-col",{attrs:{cols:"auto"}},[n._t("slot-resource-info",null,{scope:r})],2)]:n._e()],2)],1)],1)}))]}))],2)},mt=[];__vue_render__$2._withStripped=!0;const gt=undefined,vt=undefined,_t=undefined,yt=undefined,wt=normalizeComponent({render:__vue_render__$2,staticRenderFns:mt},void 0,pt,"data-v-528d59ae",!1,void 0,!1,void 0,void 0,void 0);var bt,St=void 0,kt=void 0;const Ct={name:"ComponentSwitchButton",props:{value:{type:Boolean,default:!1},size:{type:String,default:"lg"},loading:{type:Boolean,default:!1}},computed:{result:{get(){return this.value},set(n){this.$emit("input",n)}}}};var __vue_render__$1=function(){var n=this,s=n.$createElement,i=n._self._c||s;return i("div",{staticClass:"component-switch-button"},[i("b-overlay",{staticClass:"d-inline-block w-100",attrs:{show:n.loading,"spinner-small":"","spinner-variant":"primary"}},[i("b-form-checkbox",{attrs:{switch:"",size:n.size},scopedSlots:n._u([{key:"default",fn:function(){return[n._t("default")]},proxy:!0}],null,!0),model:{value:n.result,callback:function(s){n.result=s},expression:"result"}})],1)],1)},Dt=[];__vue_render__$1._withStripped=!0;const $t=undefined,Mt=undefined,zt=undefined,Ht=undefined,Tt=normalizeComponent({render:__vue_render__$1,staticRenderFns:Dt},void 0,Ct,"data-v-a09e5890",!1,void 0,!1,void 0,void 0,void 0),At={};["allowEdit","allowContinuous","allowAutoAssign"].forEach((n=>{At[`options.${n}`]=function(s){U.cookies.set({key:n,val:s})}}));var xt,Et=void 0,Lt=void 0;const Ot={name:"ComponentsCalendar",components:{scheduler:ct,resourceMenu:wt,SwitchButton:Tt},props:{loading:{type:Boolean,default:!1},today:{type:[Object,Number,String],default:()=>Date.now()},resource:{type:Array,default:()=>[]},stock:{type:Object,default:()=>({})},items:{type:Array,default:()=>[]},holiday:{type:Array,default:()=>[]},options:{type:Object,default:()=>({})}},data(){return{isMobile:window.innerWidth<992,defaultData:{hotkey:!0,defaultDate:this.now().format(this.format),defaultView:7,previewDay:1,locale:"en",views:[3,7,15,"month"],format:"YYYY-MM-DD"},selected:{startDate:this.now().format(this.format),count:7},updateViewEvent:null}},computed:{dict(){return J[this.lang]||J.en},stockData:{get(){return this.stock},set(n){this.$emit("update:stock",n)}},itemList:{get(){return this.items},set(n){this.$emit("update:items",n)}},resourceData:{get(){return this.resource},set(n){this.$emit("update:resource",n)}},optionsData:{get(){return{...this.defaultData,...this.options}},set(n){this.$emit("update:options",n)}},viewCountDefault(){const n=this.defaultData.views,s=this.optionsData?.view?.count;return void 0!==s&&n.includes(s)?s:n[1]},isViewMonth(){return"month"===this.selected.count},currentMonth(){return u(this.selected.startDate).format("MMM")},showWait(){return void 0===this.optionsData?.showWait||this.optionsData.showWait},showToolbar(){return void 0===this.optionsData?.showToolbar||this.optionsData.showToolbar},marginTop(){return JSON.parse(this.optionsData?.marginTop||0)},allowChangeDate(){return JSON.parse(this.optionsData?.allowChangeDate||!1)},allowChangeType(){return JSON.parse(this.optionsData?.allowChangeType||!1)},allowEdit(){return!this.showToolbar||JSON.parse(this.optionsData?.allowEdit||!1)},allowContinuous(){return!this.showToolbar||JSON.parse(this.optionsData?.allowContinuous||!1)},allowAutoAssign(){return!this.showToolbar||JSON.parse(this.optionsData?.allowAutoAssign||!1)},allowHotkey(){return!!this.optionsData?.hotkey},headerText(){return this.optionsData?.headerTitle},waitText(){return this.optionsData?.waitTitle},format(){return this.optionsData?.format},views(){const n=undefined;return(this.optionsData?.views||[]).map((n=>({active:this.selected.count===n,value:n})))},lang(){return U.formatLang(this.locale)},locale(){return this.optionsData?.locale||"en"},previewDay(){return-1*(this.optionsData?.previewDay||0)},dateRange(){const n=this.selected.startDate,s=this.selected.count||1,i=undefined,o=undefined;return{start:this.isViewMonth?u(this.selected.startDate).startOf("month").format(this.format):u(n).format(this.format),end:this.isViewMonth?u(this.selected.startDate).endOf("month").format(this.format):u(n).add(s-1,"days").format(this.format)}},schedulerRef(){return this.$refs?.scheduler||{}}},watch:{...At,locale(){this.dayJsLocale(this.locale)},selected:{handler(){let{count:n,startDate:s,end:i}=this.selected;this.isViewMonth?(s=u(s).startOf("month").format(this.format),i=u(s).endOf("month").format(this.format),n=u(i).diff(u(s),"days")+1):(s=u(s).format(this.format),i=u(s).add(n-1,"days").format(this.format));const o={start:s,end:i,count:n};this.optionsData={...this.optionsData,view:o},this.debounceChangeEvent&&clearTimeout(this.debounceChangeEvent),this.debounceChangeEvent=setTimeout((()=>{this.$emit("change",o),delete this.debounceChangeEvent}),100)},immediate:!1,deep:!0},"selected.count":{handler(){U.cookies.set({key:"view-count",val:this.selected.count})},immediate:!1,deep:!0}},async mounted(){this.globeEventbind(),this.getSettingCache(),await this.$nextTick(),this.init(),window.scrollToToday=function(){const n=document.querySelector(".components-calendar-main .components-scheduler"),s=document.querySelector(".components-calendar-main .components-scheduler .dates .today");if(n&&s){const{width:i,x:o}=s.getBoundingClientRect();n.scrollTo(o-3.5*i,0)}}},methods:{hasSlot(n="default"){return!!this.$slots[n]||!!this.$scopedSlots[n]},deepCopy:n=>JSON.parse(JSON.stringify(n)),init(){this.selected.count=this.viewCountDefault,this.dayJsLocale(this.locale),splitInit({el:[".components-calendar-menu",".components-calendar-main"],minSize:[200,20]}),this.viewTodayClickHandler(this.optionsData.defaultDate)},globeEventbind(){window.onresize=()=>{this.isMobile=window.innerWidth<576},this.allowHotkey&&document.addEventListener("keydown",(n=>{const s=n.which||n.keyCode,i=n.ctrlKey?n.ctrlKey:17===s,o=undefined,r=undefined;switch([n.metaKey||i,s].join()){case"true,37":n.preventDefault(),this?.viewShiftClickHandler();break;case"true,39":n.preventDefault(),this?.viewShiftClickHandler(!0);break;case"true,38":case"true,40":n.preventDefault(),this?.viewTodayClickHandler()}}))},getSettingCache(){const n=this.deepCopy(this.optionsData);["allowEdit","allowContinuous","allowAutoAssign"].forEach((s=>{n[s]=JSON.parse(U.cookies.get(s)||!1)}));const s=+U.cookies.get("view-count")||+this.optionsData.view||+this.options?.view?.count||7;this.selected.count=s,this.optionsData=n},getSize(){return this.isMobile?"":"sm"},now:n=>u(n).isValid()?u(n):u(),dayJsLocale(n){let s=n||"en";switch(s.toLowerCase()){case"zh_tw":case"zh-tw":case"zhtw":case"tw":s="zh-tw"}u.locale(s)},i18n(n){return this.dict[n]},viewsClickHandler(n){n!==this.selected.view&&(this.selected.count=n)},viewShiftClickHandler(n){if(this.isViewMonth){const s=n?1:-1;this.selected.startDate=u(this.selected.startDate).add(s,"month").startOf("month").format(this.format)}else{const s=undefined,i=(n?1:-1)*this.selected.count,o=this.dateRange;o.end=u(o.start).add(i,"days").format(this.format),this.selected.startDate=o.end}},viewTodayClickHandler(n){const s=this.now(n).add(this.previewDay,"days").format(this.format);this.selected.startDate=s},itemClickHandler(n){this.$emit("click",n)},itemAssignClickHandler(n){this.$emit("assign",n)},dropHandler(n){this.$emit("drop",n)}}};var __vue_render__=function(){var n=this,s=n.$createElement,i=n._self._c||s;return i("div",{staticClass:"components-calendar container-fluid"},[i("b-overlay",{attrs:{"spinner-variant":"primary",show:n.loading}},[i("div",{staticClass:"header"},[n._t("slot-toolbar-top"),n._v(" "),n.showToolbar?i("b-form-row",{class:["calendar-header-toolbar-top","pb-1",{small:!n.isMobile}]},[i("b-col",{attrs:{cols:"auto"}},[i("SwitchButton",{attrs:{size:"md"},model:{value:n.options.allowEdit,callback:function(s){n.$set(n.options,"allowEdit",s)},expression:"options.allowEdit"}},[n._v("\n            "+n._s(n.i18n("addnew_onder"))+"\n          ")])],1),n._v(" "),i("b-col",{attrs:{cols:"auto"}},[i("SwitchButton",{attrs:{size:"md"},model:{value:n.options.allowContinuous,callback:function(s){n.$set(n.options,"allowContinuous",s)},expression:"options.allowContinuous"}},[n._v("\n            "+n._s(n.i18n("continuous_display"))+"\n          ")])],1),n._v(" "),i("b-col",{attrs:{cols:"auto"}},[i("SwitchButton",{attrs:{size:"md"},model:{value:n.options.allowAutoAssign,callback:function(s){n.$set(n.options,"allowAutoAssign",s)},expression:"options.allowAutoAssign"}},[n._v("\n            "+n._s(n.i18n("autoassign_room"))+"\n          ")])],1)],1):n._e(),n._v(" "),i("b-form-row",[i("b-col",{staticClass:"pb-2",attrs:{cols:"12",md:"auto"}},[i("b-form-row",[n.isViewMonth?n._e():i("b-col",{attrs:{cols:"auto"}},[i("b-button",{attrs:{size:n.getSize(),variant:"outline-light"},on:{click:n.viewTodayClickHandler}},[n._v("\n                "+n._s(n.i18n("today"))+"\n              ")])],1),n._v(" "),i("b-col",{staticClass:"ml-auto",attrs:{cols:"auto"}},[i("b-button-group",{staticClass:"w-100"},[n.isViewMonth?i("span",{class:["btn","btn-outline-light","btn-"+n.getSize()]},[n._v("\n                  "+n._s(n.currentMonth)+"\n                ")]):i("input",{directives:[{name:"model",rawName:"v-model",value:n.selected.startDate,expression:"selected.startDate"}],staticClass:"form-control date-picker",attrs:{type:"date"},domProps:{value:n.selected.startDate},on:{input:function(s){s.target.composing||n.$set(n.selected,"startDate",s.target.value)}}}),n._v(" "),i("b-button",{staticClass:"mxw-60px",attrs:{size:n.getSize(),variant:"outline-light"},on:{click:function(s){return n.viewShiftClickHandler()}}},[i("i",{staticClass:"fa-solid fa-angle-left"})]),n._v(" "),i("b-button",{staticClass:"mxw-60px",attrs:{size:n.getSize(),variant:"outline-light"},on:{click:function(s){return n.viewShiftClickHandler(!0)}}},[i("i",{staticClass:"fa-solid fa-angle-right"})])],1)],1)],1)],1),n._v(" "),i("b-col",{staticClass:"pb-2",attrs:{cols:"auto"}},[i("b-button-group",n._l(n.views,(function(s,o){return i("b-button",{key:o,class:{active:s.active},attrs:{size:n.getSize(),variant:"outline-primary"},on:{click:function(i){return n.viewsClickHandler(s.value)}}},["month"===s.value?[n._v("\n                "+n._s(n.i18n(s.value))+"\n              ")]:[n._v("\n                "+n._s(s.value)+n._s(n.i18n("day"))+"\n              ")]],2)})),1)],1),n._v(" "),i("b-col",{staticClass:"right-middle pb-2"},[n._t("slot-toolbar-right")],2)],1)],2),n._v(" "),i("b-row",{staticClass:"main"},[i("div",{staticClass:"components-calendar-menu"},[i("resource-menu",{attrs:{"header-title":n.headerText,"show-wait":n.showWait,"wait-title":n.waitText,data:n.resourceData},on:{"update:data":function(s){n.resourceData=s}},scopedSlots:n._u([n.hasSlot("slot-resource-info")?{key:"slot-resource-info",fn:function(s){var i=s.scope;return[n._t("slot-resource-info",null,{scope:i})]}}:null],null,!0)})],1),n._v(" "),i("div",{staticClass:"components-calendar-main"},[i("scheduler",{ref:"scheduler",attrs:{today:n.today,"show-wait":n.showWait,"margin-top":n.marginTop,locale:n.locale,range:n.dateRange,holiday:n.holiday,resource:n.resourceData,stock:n.stockData,items:n.itemList,"allow-change-date":n.allowChangeDate,"allow-change-type":n.allowChangeType,"allow-edit":n.allowEdit,"allow-continuous":n.allowContinuous,"allow-auto-assign":n.allowAutoAssign},on:{"update:resource":function(s){n.resourceData=s},"update:stock":function(s){n.stockData=s},"update:items":function(s){n.itemList=s},click:n.itemClickHandler,assign:n.itemAssignClickHandler,drop:n.dropHandler},scopedSlots:n._u([n.hasSlot("slot-item-info")?{key:"slot-item-info",fn:function(s){var i=s.scope;return[n._t("slot-item-info",null,{scope:i})]}}:{key:"slot-item-info",fn:function(s){var o=s.scope;return[i("div",{staticClass:"p-1"},[o.payment_status?i("span",{class:["pay_status_icon",o.payment_status,{black:!o.assign}]}):n._e(),n._v(" "),o.title?i("span",[n._v("\n                "+n._s(o.title)+"\n                "),o.nan?[i("sup",[n._v(n._s(n.i18n("note"))+n._s(o.nan))])]:n._e()],2):i("span",[n._v(n._s(o.start))]),n._v(" "),i("br"),n._v(" "),i("span",[n._v(n._s(o.source)),o.order_from?i("span",[n._v(" ("+n._s(o.order_from)+")")]):n._e()])])]}},n.hasSlot("slot-item-stock")?{key:"slot-item-stock",fn:function(s){var i=s.scope;return[n._t("slot-item-stock",null,{scope:i})]}}:null],null,!0)})],1)])],1)],1)},Yt=[];__vue_render__._withStripped=!0;const jt=undefined,Rt=undefined,It=undefined,Nt=undefined,Bt=normalizeComponent({render:__vue_render__,staticRenderFns:Yt},void 0,Ot,"data-v-d1b57674",!1,void 0,!1,void 0,void 0,void 0);var Ft;const Wt=undefined,Jt=undefined,Ut=undefined,Pt=undefined,qt=undefined,Vt=undefined;return normalizeComponent({},void 0,{install:function(n){n.component("calendar",Bt)},calendar:Bt},void 0,void 0,void 0,!1,void 0,void 0,void 0)}));
//# sourceMappingURL=calendar.umd.js.map
